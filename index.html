<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Premium Cotton Graphic T-Shirt | Urban Threads</title>
    <!-- Tailwind CSS -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <!-- Alpine.js -->
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <!-- Product Viewer Component (simple file inclusion) -->
    <script src="js/alpine-product-viewer.js"></script>
</head>
<body class="bg-gray-50 p-4 md:p-8">
<!-- Product Viewer Component -->
<div x-data="productViewer(product)" class="bg-white rounded-lg shadow-lg max-w-6xl mx-auto p-6">
    <div class="flex justify-between items-center mb-6">
        <h2 class="text-3xl font-bold text-gray-800" x-text="product.name"></h2>
        <div class="flex items-center">
            <span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded" x-show="product.isFeatured">Featured</span>
        </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <!-- Product Images -->
        <div>
            <!-- Main Image -->
            <div class="w-full h-80 rounded-lg overflow-hidden mb-4 bg-gray-100 flex items-center justify-center">
                <img :src="getSelectedImage()" @error="handleImageError" class="w-full h-full object-contain" :alt="product.name">
            </div>

            <!-- Thumbnails -->
            <div class="relative" x-show="hasThumbnails()">
                <button
                        @click="scrollThumbnails('left')"
                        class="absolute left-0 top-1/2 transform -translate-y-1/2 bg-white rounded-full shadow-md z-10 p-2"
                        :class="{'opacity-50 cursor-not-allowed': isScrollLeftEnd, 'opacity-100': !isScrollLeftEnd}"
                        :disabled="isScrollLeftEnd"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                </button>

                <div class="overflow-x-auto py-2 px-8 flex space-x-3" x-ref="thumbnailsContainer" @scroll="checkScrollPosition">
                    <!-- Main product images -->
                    <template x-for="(img, index) in product.images" :key="'main-'+index">
                        <div
                                @click="selectImage(img)"
                                :class="{ 'ring-2 ring-indigo-500': selectedImage === img, 'hover:ring-2 hover:ring-gray-300': selectedImage !== img }"
                                class="flex-shrink-0 cursor-pointer rounded-md overflow-hidden transition-all duration-200 transform hover:scale-105 relative"
                        >
                            <img :src="img" :alt="`Product thumbnail ${index + 1}`" class="h-20 w-20 object-cover" @error="handleImageError">
                            <span class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs py-1 text-center">Main</span>
                        </div>
                    </template>

                    <!-- Option-specific images -->
                    <template x-for="(optionValues, optionType) in product.option_images" :key="optionType">
                        <template x-for="(images, optionValue) in optionValues" :key="optionValue">
                            <template x-for="(img, idx) in images" :key="`${optionType}-${optionValue}-${idx}`">
                                <div
                                        @click="selectImage(img); selectOptionFromImage(optionType, optionValue)"
                                        :class="{ 'ring-2 ring-indigo-500': selectedImage === img, 'hover:ring-2 hover:ring-gray-300': selectedImage !== img }"
                                        class="flex-shrink-0 cursor-pointer rounded-md overflow-hidden transition-all duration-200 transform hover:scale-105 relative"
                                >
                                    <img :src="img" :alt="`${optionValue} ${optionType}`" class="h-20 w-20 object-cover" @error="handleImageError">
                                    <span class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs py-1 text-center" x-text="optionValue"></span>
                                </div>
                            </template>
                        </template>
                    </template>

                    <!-- Variant images -->
                    <template x-for="(img, variantKey) in product.variant_images" :key="variantKey">
                        <div
                                @click="selectImage(Array.isArray(img) ? img[0] : img); selectVariantFromKey(variantKey)"
                                :class="{ 'ring-2 ring-indigo-500': selectedImage === (Array.isArray(img) ? img[0] : img), 'hover:ring-2 hover:ring-gray-300': selectedImage !== (Array.isArray(img) ? img[0] : img) }"
                                class="flex-shrink-0 cursor-pointer rounded-md overflow-hidden transition-all duration-200 transform hover:scale-105 relative"
                        >
                            <img :src="Array.isArray(img) ? img[0] : img" :alt="`Variant ${variantKey}`" class="h-20 w-20 object-cover" @error="handleImageError">
                            <span class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs py-1 text-center" x-text="formatVariantName(variantKey)"></span>
                        </div>
                    </template>
                </div>

                <button
                        @click="scrollThumbnails('right')"
                        class="absolute right-0 top-1/2 transform -translate-y-1/2 bg-white rounded-full shadow-md z-10 p-2"
                        :class="{'opacity-50 cursor-not-allowed': isScrollRightEnd, 'opacity-100': !isScrollRightEnd}"
                        :disabled="isScrollRightEnd"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Product Details -->
        <div>
            <div class="flex items-center mb-4">
                <span class="text-sm text-gray-600 mr-2">By</span>
                <span class="font-medium text-gray-800" x-text="product.brand"></span>
            </div>

            <p class="text-gray-600 mb-4" x-text="product.description"></p>

            <!-- Rating display -->
            <div class="flex items-center mb-4" x-show="product.rating">
                <div class="flex text-yellow-400">
                    <template x-for="i in 5" :key="i">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" :class="i <= Math.round(product.rating) ? 'text-yellow-400' : 'text-gray-300'" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                        </svg>
                    </template>
                </div>
                <span class="ml-2 text-gray-600" x-text="`${product.rating} (${product.reviews_count} reviews)`"></span>
            </div>

            <div class="mb-6">
                <div class="flex items-end gap-2">
                    <p class="text-3xl font-bold text-gray-900" x-text="formatPrice(calculateCurrentPrice())"></p>
                    <span class="text-sm text-gray-500" x-show="product.isOnSale">Sale</span>
                </div>
                <p class="text-sm text-gray-500" x-text="`SKU: ${product.sku}`"></p>
            </div>

            <!-- Product options -->
            <div class="space-y-4 mb-6" x-show="product.options && Object.keys(product.options).length > 0">
                <template x-for="(values, option) in product.options" :key="option">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 capitalize mb-2" x-text="formatOptionName(option)"></label>
                        <div class="flex flex-wrap gap-2">
                            <template x-for="(value, idx) in values" :key="idx">
                                <button
                                        class="px-4 py-2 border rounded-md hover:border-indigo-500 transition-colors duration-200"
                                        :class="selectedOptions[option] === value ? 'border-indigo-500 bg-indigo-50 text-indigo-700' : 'border-gray-300 text-gray-700'"
                                        @click="selectOption(option, value)"
                                        x-text="value"
                                ></button>
                            </template>
                        </div>
                    </div>
                </template>
            </div>

            <!-- Inventory display -->
            <div class="flex items-center mb-4">
                <span class="mr-2 text-sm font-medium text-gray-700">Availability:</span>
                <span x-show="getInventoryForSelection() > 0" class="text-green-600 font-medium" x-text="`${getInventoryForSelection()} in stock`"></span>
                <span x-show="getInventoryForSelection() <= 0" class="text-red-600 font-medium">Out of stock</span>
            </div>

            <!-- Shipping info -->
            <div class="mb-6">
                <span class="text-sm font-medium text-gray-700">Shipping:</span>
                <span x-text="getShippingInfo()" class="text-sm ml-1"></span>
            </div>

            <!-- Add to Cart button -->
            <button
                    class="w-full bg-indigo-600 text-white py-3 px-6 rounded-md font-medium hover:bg-indigo-700 transition-colors duration-200 mb-6"
                    :class="{'opacity-50 cursor-not-allowed': getInventoryForSelection() <= 0, 'opacity-100': getInventoryForSelection() > 0}"
                    :disabled="getInventoryForSelection() <= 0"
            >
                Add to Cart
            </button>

            <!-- Features -->
            <div class="border-t border-gray-200 pt-4" x-show="product.features && Object.keys(product.features).length > 0">
                <h3 class="text-lg font-medium mb-3">Features</h3>
                <ul class="space-y-2">
                    <template x-for="(value, key) in product.features" :key="key">
                        <li class="flex">
                            <svg class="h-5 w-5 text-green-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            <span x-text="`${formatFeatureKey(key)}: ${value}`"></span>
                        </li>
                    </template>
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- Product Data Initialization -->
<script>
    // Initialize the product data
    const product = {
        // Basic Information
        id: 2501,
        name: "Premium Cotton Graphic T-Shirt",
        description: "Ultra-soft premium cotton t-shirt with original graphic designs. Pre-shrunk fabric with modern fit and reinforced stitching for durability.",
        base_price: 24.99,
        base_shipping_cost: 4.99,
        free_shipping: false,
        sku: "APPRL-TS-2501",
        slug: "premium-cotton-graphic-tshirt",
        brand: "Urban Threads",
        rating: 4.8,
        reviews_count: 236,
        // Status Information
        status: "active",
        isFeatured: true,
        isOnSale: false, // Can be overridden by logic later if needed
        requiresShipping: true,
        // Stock Management
        requiresInventoryTracking: true,
        stock: 25, // Default stock - often overridden by variants
        hasVariants: true,
        totalVariantStock: 485,
        lowStockThreshold: 10,
        // Product Details
        features: { material: "100% Ringspun Cotton, 180gsm", fit: "Modern fit, slightly tapered", neckline: "Reinforced crew neck", care: "Machine wash cold, tumble dry low", printing: "Water-based eco-friendly inks", origin: "Ethically manufactured", sustainability: "GOTS certified organic cotton" },
        // Main product images
        images: [
            "https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=800&auto=format&fit=crop",
            "https://images.unsplash.com/photo-1503341504253-dff4815485f1?w=800&auto=format&fit=crop",
            "https://images.unsplash.com/photo-1583743814966-8936f5b7be1a?w=800&auto=format&fit=crop"
        ],
        // Product Configuration
        options: {
            "size": ["xs", "s", "m", "l", "xl", "2xl"],
            "color": ["white", "black", "navy", "heather gray"],
            "design": ["mountain", "wave", "sunset", "minimal"]
        },
        // Option Images
        option_images: {
            "color": {
                "white": ["https://images.unsplash.com/photo-1581655353564-df123a1eb820?w=800&auto=format&fit=crop"],
                "black": ["https://images.unsplash.com/photo-1618354691373-d851c5c3a990?w=800&auto=format&fit=crop"],
                "navy": ["https://images.unsplash.com/photo-1618354691438-25bc04584c23?w=800&auto=format&fit=crop"],
                "heather gray": ["https://images.unsplash.com/photo-1618354691229-a8f91e7a3eb9?w=800&auto=format&fit=crop"]
            },
            "design": {
                "mountain": ["https://images.unsplash.com/photo-1564412811189-a6d55a176f6c?w=800&auto=format&fit=crop"],
                "wave": ["https://images.unsplash.com/photo-1533577116850-9cc66cad8a9b?w=800&auto=format&fit=crop"],
                "sunset": ["https://images.unsplash.com/photo-1549880338-65ddcdfd017b?w=800&auto=format&fit=crop"],
                "minimal": ["https://images.unsplash.com/photo-1567632661587-deaffec88b38?w=800&auto=format&fit=crop"]
            }
        },
        // Variant Images - Images for specific combinations of options
        variant_images: {
            "white|mountain": "https://images.unsplash.com/photo-1527719327859-c6ce80353573?w=800&auto=format&fit=crop",
            "black|mountain": "https://images.unsplash.com/photo-1503342394128-c104d54dba01?w=800&auto=format&fit=crop",
            "white|wave": "https://images.unsplash.com/photo-1574180566232-aaad1b5b8450?w=800&auto=format&fit=crop",
            "navy|sunset": ["https://images.unsplash.com/photo-1622445275463-afa2ab738c34?w=800&auto=format&fit=crop", "https://images.unsplash.com/photo-1622445275576-721325763afe?w=800&auto=format&fit=crop"],
            "heather gray|minimal": "https://images.unsplash.com/photo-1576566588028-4147f3842f27?w=800&auto=format&fit=crop"
        },
        // Option Variants Stock
        option_variants_stock: {
            "xs|white|mountain": 20, "s|white|mountain": 30, "m|white|mountain": 25, "l|white|mountain": 20, "xl|white|mountain": 15, "2xl|white|mountain": 10,
            "xs|black|mountain": 15, "s|black|mountain": 25, "m|black|mountain": 30, "l|black|mountain": 25, "xl|black|mountain": 15, "2xl|black|mountain": 10,
            "xs|navy|mountain": 10, "s|navy|mountain": 15, "m|navy|mountain": 20, "l|navy|mountain": 15, "xl|navy|mountain": 10, "2xl|navy|mountain": 5,
            "xs|white|wave": 10, "s|white|wave": 15, "m|white|wave": 20, "l|white|wave": 15, "xl|white|wave": 10, "2xl|white|wave": 5,
            "s|black|wave": 10, "m|black|wave": 15, "l|black|wave": 15, "xl|black|wave": 10,
            "s|navy|sunset": 10, "m|navy|sunset": 15, "l|navy|sunset": 15, "xl|navy|sunset": 10,
            "s|heather gray|minimal": 15, "m|heather gray|minimal": 20, "l|heather gray|minimal": 15, "xl|heather gray|minimal": 10
        },
        // Option Price Adjustments
        option_price_adjustments: { "size:xl": 2.00, "size:2xl": 4.00, "color:heather gray": 1.50, "design:sunset": 2.00 },
        // Option Shipping Adjustments
        option_shipping_adjustments: { "size:xl": 2.00, "size:2xl": 3.50 },
        // Physical Attributes
        weight: { value: 0.22, unit: 'kg' },
        dimensions: { length: 30, width: 25, height: 2, unit: 'cm' },
        // Option Dimension Overrides
        option_dimension_overrides: { "size:2xl": { weight: { value: 0.28, unit: 'kg' }, dimensions: { length: 35, width: 30, height: 2, unit: 'cm' } } },
        // Categories
        categories: [101, 105, 110], // Apparel, T-Shirts, Graphic Tees
        // Related Products
        upselling: [2510, 2515], // Premium hoodie, long sleeve version
        crossSelling: [2601, 2701], // Joggers, hat with matching designs
        relatedProducts: [2502, 2503], // Other t-shirt designs
        // Timestamps
        createdAt: "2025-02-15T10:20:00Z",
        updatedAt: "2025-04-01T16:45:00Z"
    };
</script>
</body>
</html>